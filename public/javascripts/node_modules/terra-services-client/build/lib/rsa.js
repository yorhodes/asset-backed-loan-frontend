(function(){var d,c=function(b,a){return function(){return b.apply(a,arguments)}};d=function(){function b(){this["public"]=c(this["public"],this);this["private"]=c(this["private"],this);this.set_public=c(this.set_public,this);this.set_private=c(this.set_private,this);this.NodeRSA=require("node-rsa");this.pub=this.priv=!1;this.sec=2048}b.prototype.format={strip:function(a){return a.split("\n").slice(1,-1).join("\n")},decorate:function(a,b){switch(a){case "private":return this.header["private"]+"\n"+
b+"\n"+this.footer["private"];case "public":return this.header["public"]+"\n"+b+"\n"+this.footer["public"]}},header:{"public":"-----BEGIN PUBLIC KEY-----","private":"-----BEGIN RSA PRIVATE KEY-----"},footer:{"public":"-----END PUBLIC KEY-----","private":"-----END RSA PRIVATE KEY-----"}};b.prototype.gen=function(){var a;return this.pub=this.priv=a=new this.NodeRSA({b:this.sec})};b.prototype.set_private=function(a){this.priv=new this.NodeRSA;return this.priv.importKey(this.format.decorate("private",
a),"private")};b.prototype.set_public=function(a){this.pub=new this.NodeRSA;return this.pub.importKey(this.format.decorate("public",a),"public")};b.prototype["private"]=function(){return this.format.strip(this.priv.exportKey("private"))};b.prototype["public"]=function(){return this.format.strip(this.pub.exportKey("public"))};b.prototype.encrypt=function(a){return this.pub.encrypt(a,"base64")};b.prototype.decrypt=function(a){return this.priv.decrypt(a,"utf8")};return b}();module.exports=d}).call(this);
